<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='ほとんどの言語で、特定の条件に合致した場合にのみ実行する処理を書くには、ifのように分岐処理のための構文を使うのが当たり前のように考えられて'><title>ifでの分岐を考える</title>
<link rel=canonical href=https://retheviper.github.io/posts/kotlin-if-to-non-if/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property='og:title' content='ifでの分岐を考える'><meta property='og:description' content='ほとんどの言語で、特定の条件に合致した場合にのみ実行する処理を書くには、ifのように分岐処理のための構文を使うのが当たり前のように考えられて'><meta property='og:url' content='https://retheviper.github.io/posts/kotlin-if-to-non-if/'><meta property='og:site_name' content='Korean-man in Tokyo'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='kotlin'><meta property='article:published_time' content='2022-11-20T00:00:00+00:00'><meta property='article:modified_time' content='2022-11-20T00:00:00+00:00'><meta property='og:image' content='https://retheviper.github.io/images/kotlin.jpg'><meta name=twitter:title content="ifでの分岐を考える"><meta name=twitter:description content="ほとんどの言語で、特定の条件に合致した場合にのみ実行する処理を書くには、ifのように分岐処理のための構文を使うのが当たり前のように考えられて"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://retheviper.github.io/images/kotlin.jpg'><link rel="shortcut icon" href=/favicon.ico><link rel=icon href=/favicon/favicon.ico><link rel=mask-icon href=safari-pinned-tab.svg color=black><link rel=manifest href=/favicon/manifest.json><script async src="https://www.googletagmanager.com/gtag/js?id=G-BYJBEJB6DX"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BYJBEJB6DX",{anonymize_ip:!1})}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu768313a802c015f07dded3abd3d4245d_264018_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>👋</span></figure><div class=site-meta><h1 class=site-name><a href=/>Korean-man in Tokyo</a></h1><h2 class=site-description>一人前になりたいです</h2></div></header><ol class=social-menu><li><a href=https://www.credly.com/users/youngbin-kim.6d7122f1/badges target=_blank title=Certificates rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-certificate" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="15" cy="15" r="3"/><path d="M13 17.5V22l2-1.5 2 1.5v-4.5"/><path d="M10 19H5a2 2 0 01-2-2V7c0-1.1.9-2 2-2h14a2 2 0 012 2v10a2 2 0 01-1 1.73"/><line x1="6" y1="9" x2="18" y2="9"/><line x1="6" y1="12" x2="9" y2="12"/><line x1="6" y1="15" x2="8" y2="15"/></svg></a></li><li><a href=https://github.com/retheviper target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/%E8%8B%B1%E6%96%8C-%E9%87%91-6736ba194/ target=_blank title=LinkedIn rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://retheviper.github.io/index.xml target=_blank title=RSS rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://retheviper.github.io/ selected></option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#if文の例>if文の例</a></li><li><a href=#関数のリファクタ>関数のリファクタ</a><ol><li><a href=#標準ライブラリ>標準ライブラリ</a></li><li><a href=#when>when</a></li><li><a href=#拡張関数>拡張関数</a></li><li><a href=#map>Map</a></li></ol></li><li><a href=#oop的な考え方>OOP的な考え方</a><ol><li><a href=#interface抽出>interface抽出</a></li><li><a href=#factory>Factory</a></li><li><a href=#enum>Enum</a></li></ol></li><li><a href=#最後に>最後に</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/kotlin-if-to-non-if/><img src=/images/kotlin.jpg loading=lazy alt="Featured image of post ifでの分岐を考える"></a></div><div class=article-details><header class=article-category><a href=/categories/kotlin/ style=background-color:#2a9d8f;color:#fff>kotlin</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/kotlin-if-to-non-if/>ifでの分岐を考える</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 20, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>10 minute read</time></div></footer></div></header><section class=article-content><p>ほとんどの言語で、特定の条件に合致した場合にのみ実行する処理を書くには、<code>if</code>のように分岐処理のための構文を使うのが当たり前のように考えられています。言語によっては構文ではなく式として扱われたり、<code>switch</code>や三項演算子のような他の選択肢も存在しますが、基本的に「条件とそれに従う処理」を書く機能として本質は変わらないものですね。</p><p>分岐処理に限った話ではありませんが、便利な道具というのは時に危険性を伴うこともあります。<code>if</code>を使う場合、最初の実装ではわかりやすく簡単に目的を達成できますが、維持保守の観点からするとあまり良くない選択になるケースもありますね。たとえば条件が増えたり変わるなどコードに変更が必要となった場合は修正がすべてのケースを網羅しているかどうかがわからなくなったり、ユニットテストが困難になったりするなどが考えられます。</p><p>なので少なくとも<code>if</code>の処理をよりシンプルにしたり、もしくはデザインパターンなどで分岐の構文を使わず同じ処理ができるように改善する必要が出てくることもあるかなと思います。そうすることで、コードリーディングはより難しくなるとしても、維持保守の観点からはより良いコードになる可能性もあるでしょう。</p><p>もちろん、完全に<code>if</code>をなくするというのは不可能に近い話で、そこまでする必要もありません。道具自体に罪はなく、あくまで使い方が問題になるだけですので。ここではあくまで、<code>if</code>を使ったコードをどういう風にリファクタできるか、それだけに集中したいと思います。（初心者向けな感じで）</p><h2 id=if文の例>if文の例</h2><p>まずは、以下の関数をご覧ください。コードと価格を渡したら、内部ではコードに合わせて元の価格から割引の値を返すというものです。極めて単純化してはいますが、ECサイトのプロモーションなどでこのような処理が存在することもあるかなと思います。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> (code <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Facebook&#34;</span>) {
</span></span><span style=display:flex><span>        (amount * <span style=color:#ae81ff>0.1</span>).roundToInt()
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (code <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Twitter&#34;</span>) {
</span></span><span style=display:flex><span>        (amount * <span style=color:#ae81ff>0.15</span>).roundToInt()
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (code <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Instagram&#34;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (amount &lt; <span style=color:#ae81ff>1000</span>) {
</span></span><span style=display:flex><span>            amount
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>すでにどのように処理をリファクタすれば良いか、一目でわかる方もいらっしゃるかなと思いますが、ここでは色々な観点でどうコードを変えられるかを述べたいので、一つ一つ項目を挙げて説明したいと思います。</p><h2 id=関数のリファクタ>関数のリファクタ</h2><p>まずは関数内の処理をどう変えられるかを考えてみます。コードをより単純化して可読性を向上したり、処理の漏れをなくしたり、共通化できたり処理の単位が曖昧な場合は分離するなどいろいろな方法が考えられるはずです。</p><h3 id=標準ライブラリ>標準ライブラリ</h3><p>上記の関数では<code>if</code>の中にさらに<code>if</code>が入っている構造となっているのがわかります。このようなネストは深くなれば深くなるほど良いコードとは言えませんね。なのでまずはここから直していきましょう。</p><p><code>if</code>のネストを一つ減らす方法として、標準ライブラリを用いた方法を考えられます。標準ライブラリでなくでも関数として分離するという選択もありますが、標準ライブラリに処理を委任することでこの関数の負担がまず減るかなと思います。</p><p>Kotlinには<a class=link href=https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.ranges/coerce-at-least.html target=_blank rel=noopener>coerceAtLeast()</a>という関数があり、パラメータとして渡された値をミニマムとして返すという働きをします。なので、<code>amount</code>が1000以下の場合は<code>amount</code>自身を、それ以外は1000を返すという処理はこの関数を使うことで単純化できます。以下のようにですね。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> (code <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Facebook&#34;</span>) {
</span></span><span style=display:flex><span>        (amount * <span style=color:#ae81ff>0.1</span>).roundToInt()
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (code <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Twitter&#34;</span>) {
</span></span><span style=display:flex><span>        (amount * <span style=color:#ae81ff>0.15</span>).roundToInt()
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (code <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Instagram&#34;</span>) {
</span></span><span style=display:flex><span>        amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>) <span style=color:#75715e>// 閾値を超えない値となる
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>単純に標準ライブラリを使用しただけですが、ネストが一つなくなりより単純なコードになりました。また、ここでの修正により閾値の修正が必要になった場合でも、1箇所だけを修正すると良いというメリットもありますね。</p><p>他にも標準ライブラリで処理ができそうな場所は積極的に利用したり、似たような処理が繰り返されるところがあったら切り出して自前のライブラリとして分離しておくことも良い選択になるでしょう。</p><h3 id=when>when</h3><p>もう一つのリファクタとしては、<code>if</code>を<code>when</code>(他の言語の<code>switch</code>)に入れ替えるという方法を考えられます。<code>when</code>は結果的に同じ機能をするので、常に<code>if</code>の代替として良いというわけではありません。しかし、ifの条件が一律であれば、<code>when</code>を選ぶのは良い選択になる場合があります。</p><p>先ほどの<code>if</code>で分岐する条件は、あくまで<code>code</code>という文字列がどのような値となっているか比較することだけですね。他には特に条件がないので、<code>when</code>を用いた方がブランチを文字列だけで収めるのでより単純化つ明瞭なコードになります。たとえば以下のようにです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>when</span> (code) { <span style=color:#75715e>// codeの値を比較するだけの分岐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#e6db74>&#34;Facebook&#34;</span> <span style=color:#f92672>-&gt;</span> (amount * <span style=color:#ae81ff>0.1</span>).roundToInt()
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Twitter&#34;</span> <span style=color:#f92672>-&gt;</span> (amount * <span style=color:#ae81ff>0.15</span>).roundToInt()
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Instagram&#34;</span> <span style=color:#f92672>-&gt;</span> amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>if</code>を<code>when</code>に変えただけで、全体的に短くなってより読みやすいコードになっているかと思います。このように、<code>if</code>の条件文がどのようなものかをみて、<code>when</code>に変えるのも場合によっては良い選択の一つになり得るかなと思います。</p><h3 id=拡張関数>拡張関数</h3><p>Kotlinのような言語には、拡張関数で既存のクラスにメソッドを追加する機能がありますね。同じような処理が2箇所以上繰り返されているなら関数として分離を考慮すべきで、その関数を拡張関数として定義することも場合によっては考えられます。</p><p>ここでは<code>code</code>が<code>Facebook</code>か<code>Twitter</code>かによる分岐がありますが、やりたいことは<code>amount</code>に特定のパーセンテージをかけて返すことですね。なので、パーセンテージを求める関数を定義しておいた方が良いでしょう。</p><p>パーセンテージを求めるのはここでしか使わないとしたら<code>private</code>な関数として定義しても良いのですが、より汎用的な使い方ができるようにしたいなら、以下のような拡張関数を定義するのもありでしょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// パーセントを求める拡張関数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>infix</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>Int</span>.percentOf(amount: Int): Int = (amount * <span style=color:#66d9ef>this</span> / <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>when</span> (code) {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Facebook&#34;</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>10</span> percentOf amount <span style=color:#75715e>// 10パーセントの値を返す
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#e6db74>&#34;Twitter&#34;</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>15</span> percentOf amount <span style=color:#75715e>// 15パーセントの値を返す
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#e6db74>&#34;Instagram&#34;</span> <span style=color:#f92672>-&gt;</span> amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>先のほどのコードと比べ、拡張関数を定義することで処理の共通化ができたことと共に、「パーセントを計算する」という意図がコードでより明確に表れているようになっているのではないかと思います。</p><h3 id=map>Map</h3><p><code>if</code>や<code>when</code>を使わない場合でも分岐ができる場合はあります。たとえば<code>Map</code>を活用する方法ですね。<code>code</code>によって違う値を掛け算したいので、<code>code</code>をKeyに、掛けたい値をValueとするMapを定義しておくことです。たとえば以下のようなものです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// コードと割引率
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> discountPercentages = mapOf(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Facebook&#34;</span> to <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Twitter&#34;</span> to <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 割引率が定義してあったら掛け算
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    discountPercentages[code]<span style=color:#f92672>?.</span>let {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>it</span> percentOf amount
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Mapにないcodeの場合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>when</span> (code) {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Instagram&#34;</span> <span style=color:#f92672>-&gt;</span> amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ただ、この方法では全ての分岐を網羅することはできなくなりますね。<code>code</code>の値ががMapのKeyに含まれてない場合の処理が必要となるからです。ここでクロージャを用いると<code>code</code>の値が<code>Instagram</code>の場合の処理もMapに含めることができます。たとえば以下のようにですね。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// Valueを(Int) -&gt; Intに変える
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> discountRules = mapOf(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Facebook&#34;</span> to { amount: Int <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>10</span> percentOf amount },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Twitter&#34;</span> to { amount: Int <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>15</span> percentOf amount },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Instagram&#34;</span> to { amount: Int <span style=color:#f92672>-&gt;</span> amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>) }
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> discountRules[code]<span style=color:#f92672>?.</span>let { <span style=color:#66d9ef>it</span>(amount) } <span style=color:#f92672>?:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Mapを利用する方法が条件分岐より良い方法だとは言い切れないのですが、コード別の割引率を他の関数でも参照する必要があるなど、複数の関数やクラスを跨いで共通の値を保持しておきたい場合は考えられる方法の一つになるかなと思います。この場合は、Map一つを修正するだけで全体の処理で整合性が保証されるコードになるという効果がありますね。</p><h2 id=oop的な考え方>OOP的な考え方</h2><p>今までは単純に関数内部の処理をどう変えていくかについて述べましたが、より高度な方法ももちろんあります。OOPの考え方として捉えると、先ほどの関数は「割引額を求める」責任がありますが、その中で「割引」の定義そのものと、その計算式まで持っていることになります。なので、責任を分離していく必要がありますね。</p><p>この修正に処理は一見より複雑なものになっていくと感じる場合もあるかと思いますが、これはOOPに原則である<a class=link href=https://ja.wikipedia.org/wiki/SOLID target=_blank rel=noopener>SOLID</a>を考慮したものでもあります。長期的な観点からすると、このような方法をとった方がより維持保守には向いていることになるでしょう。</p><h3 id=interface抽出>interface抽出</h3><p>まずは「割引ポリシー」を<code>insterface</code>として分離します。この割引ポリシーを実装するクラスで実際のポリシーに従う割引額を計算するイメージです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DiscountPolicy</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>companion</span> <span style=color:#66d9ef>object</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> NONE: DiscountPolicy = <span style=color:#66d9ef>object</span> <span style=color:#960050;background-color:#1e0010>: </span><span style=color:#a6e22e>DiscountPolicy</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>あとはこの<code>interface</code>を実装するクラスを、コード別に定義しておきます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FacebookDiscountPolicy</span> : DiscountPolicy {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = <span style=color:#ae81ff>10</span> percentOf amount
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TwitterDiscountPolicy</span> : DiscountPolicy {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = <span style=color:#ae81ff>15</span> percentOf amount
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>InstagramDiscountPolicy</span> : DiscountPolicy {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>こうやって割引ポリシーを定義しておくと、<code>getDiscountAmount()</code>は以下のように変えられるでしょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> discountPolicy = <span style=color:#66d9ef>when</span> (code) {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Facebook&#34;</span> <span style=color:#f92672>-&gt;</span> FacebookDiscountPolicy()
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Twitter&#34;</span> <span style=color:#f92672>-&gt;</span> TwitterDiscountPolicy()
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Instagram&#34;</span> <span style=color:#f92672>-&gt;</span> InstagramDiscountPolicy()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#f92672>-&gt;</span> <span style=color:#a6e22e>DiscountPolicy</span>.NONE
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> discountPolicy.calculate(amount)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=factory>Factory</h3><p>先ほどの<code>interface</code>抽出で割引ポリシー自体は分離できたものの、<code>getDiscountAmount()</code>ではまだ「割引ポリシーを生成する」という責任を持っています。これもまた別の役割として分離ができるでしょう。ここは以下のように割引ポリシーを生成する<code>Factory</code>を定義しておくと良いでしょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>object</span> <span style=color:#a6e22e>DiscountPolicyFactory</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountPolicy</span>(code: String): DiscountPolicy {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>when</span> (code) {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Facebook&#34;</span> <span style=color:#f92672>-&gt;</span> FacebookDiscountPolicy()
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Twitter&#34;</span> <span style=color:#f92672>-&gt;</span> TwitterDiscountPolicy()
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Instagram&#34;</span> <span style=color:#f92672>-&gt;</span> InstagramDiscountPolicy()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#f92672>-&gt;</span> <span style=color:#a6e22e>DiscountPolicy</span>.NONE
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>最終的に、<code>getDiscountAmount()</code>は以下のように修正できます。<code>interface</code>の抽出や<code>Factory</code>の作成でコードの量は増えましたが、この関数の責任はより軽くなり、割引ポリシーの追加や修正が必要な場合でも柔軟な対応ができるようになりました。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> discountPolicy = <span style=color:#a6e22e>DiscountFactory</span>.getDiscountPolicy(code)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> discountPolicy.calculate(amount)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=enum>Enum</h3><p>割引ポリシーを生成するために<code>Factory</code>を使う代わりに、<code>Enum</code>を使うこともできます。先ほどの<code>DiscountPolicy</code>を継承して、クラスではなく列挙定数として扱う方法です。たとえば以下のようなものが定義できます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DiscountPolicies</span>(<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> code: String) : DiscountPolicy {
</span></span><span style=display:flex><span>    FACEBOOK(<span style=color:#e6db74>&#34;Facebook&#34;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = <span style=color:#ae81ff>10</span> percentOf amount
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    TWITTER(<span style=color:#e6db74>&#34;Twitter&#34;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = <span style=color:#ae81ff>15</span> percentOf amount
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    INSTAGRAM(<span style=color:#e6db74>&#34;Instagram&#34;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>calculate</span>(amount: Int): Int = amount.coerceAtLeast(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>companion</span> <span style=color:#66d9ef>object</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>fromCode</span>(code: String): DiscountPolicy {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> values().find { <span style=color:#66d9ef>it</span>.code <span style=color:#f92672>==</span> code } <span style=color:#f92672>?:</span> <span style=color:#a6e22e>DiscountPolicy</span>.NONE
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上記の<code>Enum</code>を利用する場合、<code>getDiscountAmount()</code>は以下のようになるでしょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getDiscountAmount</span>(code: String, amount: Int): Int {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> discountPolicy = <span style=color:#a6e22e>DiscountPolicies</span>.fromCode(code)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> discountPolicy.calculate(amount)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>Enum</code>の場合、<code>fromCode()</code>で<code>code</code>による分岐そのものが必要なくなり、割引ポリシを追加したい場合でも列挙定数を追加することで拡張も容易にできるので<code>Factory</code>よりも良い方法ではないかと思います。</p><h2 id=最後に>最後に</h2><p>最初に断っておいたように、全ての<code>if</code>をなくすのは不可能に近い話で、そうする必要もありません。しかしその<code>if</code>が行っている処理の本質、責任、可読性のような要素は注意深く観察する必要があり、最初は<code>if</code>でとりあえず動くコードを作ったあとは他の方法で改善できるかどうか振り返ってみる必要はあるかなと思います。</p><p>こういう自分も常に綺麗なコードを書いているわけではないのですが、たまにはこうやって初心者の気持ちで自分の書いたコードを振り返ってみるという姿勢は常に必要なのではという気持ちにもなります。良いコードを書くのは常に難しいものですね。でも、難しいことを最初にやっておいた方が後に後悔しないことにもつながるだろうと思います。</p><p>では、また！</p></section><footer class=article-footer><section class=article-tags><a href=/tags/kotlin/>Kotlin</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/kotlin-code-in-my-style-4/><div class=article-image><img src=/images/kotlin.jpg loading=lazy data-key data-hash=/images/kotlin.jpg></div><div class=article-details><h2 class=article-title>Kotlinで書いてみた〜その四〜</h2></div></a></article><article class=has-image><a href=/posts/kotlin-conf-2023/><div class=article-image><img src=/images/kotlin.jpg loading=lazy data-key data-hash=/images/kotlin.jpg></div><div class=article-details><h2 class=article-title>KotlinConf'23を要約してみた</h2></div></a></article><article class=has-image><a href=/posts/kotlin-how-to-kotlin-like/><div class=article-image><img src=/images/kotlin.jpg loading=lazy data-key data-hash=/images/kotlin.jpg></div><div class=article-details><h2 class=article-title>Kotlinはどう書いたらいいか</h2></div></a></article><article class=has-image><a href=/posts/kotlin-compose-web/><div class=article-image><img src=/images/kotlin.jpg loading=lazy data-key data-hash=/images/kotlin.jpg></div><div class=article-details><h2 class=article-title>Kotlinだけでファイルサーバを作ってみた</h2></div></a></article><article class=has-image><a href=/posts/kotlin-compose-desktop/><div class=article-image><img src=/images/kotlin.jpg loading=lazy data-key data-hash=/images/kotlin.jpg></div><div class=article-details><h2 class=article-title>Kotlinでデスクトップアプリを作ってみた</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2019 -
2024 Korean-man in Tokyo</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.20.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>