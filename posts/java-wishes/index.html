<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Javaは長い間業界で生産性、性能、安定性で評判がよく、最近はバージョンアップも様々な機能が追加されています。仕事では主に11バージョンを使"><title>Javaはこう進化して欲しい</title>
<link rel=canonical href=https://retheviper.github.io/posts/java-wishes/>
<link rel=stylesheet href=/scss/style.min.1b3ac667198cb83edcc9c45e606a6f4dd6910b8ada6b74d7fd988f1b2dfd0c7c.css><meta property="og:title" content="Javaはこう進化して欲しい">
<meta property="og:description" content="Javaは長い間業界で生産性、性能、安定性で評判がよく、最近はバージョンアップも様々な機能が追加されています。仕事では主に11バージョンを使">
<meta property="og:url" content="https://retheviper.github.io/posts/java-wishes/">
<meta property="og:site_name" content="Korean-man in Tokyo">
<meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="java"><meta property="article:published_time" content="2020-02-03T00:00:00+00:00"><meta property="article:modified_time" content="2020-02-03T00:00:00+00:00"><meta property="og:image" content="https://retheviper.github.io/images/java.jpg">
<meta name=twitter:title content="Javaはこう進化して欲しい">
<meta name=twitter:description content="Javaは長い間業界で生産性、性能、安定性で評判がよく、最近はバージョンアップも様々な機能が追加されています。仕事では主に11バージョンを使"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://retheviper.github.io/images/java.jpg">
<link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png>
<link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png>
<link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png>
<link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png>
<link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png>
<link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png>
<link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png>
<link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png>
<link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png>
<link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png>
<link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png>
<link rel=manifest href=/favicon/manifest.json>
<meta name=msapplication-TileColor content="#ffffff">
<meta name=msapplication-TileImage content="/favicon/ms-icon-144x144.png">
<meta name=theme-color content="#ffffff">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-139986442-1','auto'),ga('send','pageview'))</script>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/posts/java-wishes/>
<img src=/../../images/java.jpg loading=lazy alt="Featured image of post Javaはこう進化して欲しい">
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/java/ style=background-color:#2a9d8f;color:#fff>
java
</a>
</header>
<h2 class=article-title>
<a href=/posts/java-wishes/>Javaはこう進化して欲しい</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Feb 03, 2020</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
9 minute read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<p>Javaは長い間業界で生産性、性能、安定性で評判がよく、最近はバージョンアップも様々な機能が追加されています。仕事では主に11バージョンを使っていますが、次のLTSバージョンである17がリリーズされたらそちらを使うことになるのではないかと思います。なので今も新しいバージョンが発表されると一応更新履歴には目を通していますが、言語仕様そのものが変わる場合は新しいAPIの追加と比べ少ない気がしなくもないです。</p>
<p>Javaが人気を得た理由の一つの生産性という部分では、今じゃPythonやJavaScriptなどに比べて劣る部分もあり、「コードが読みやすい」というメリットも、いつの間にか「冗長すぎる」という評価と変わってしまいましたね。自分はJavaが好きで、まだ言語そのものの仕様まで見切ってはいないですが、それでも使いながらこれは不便だな、これは他の言語と同じくなって欲しいなと思う時もあります。今回のポストでは仕事でJavaを扱いながら感じた不便なところ、また他の言語と比べて改善したいところについて述べたいと思います。こうして他の言語と比べ、Javaがどんなものであるかを把握していくのもまた一つの勉強になるのでは、と思いますので。</p>
<h2 id=optional表記の改善>Optional表記の改善</h2>
<p>以前のポスト](../../../01/05/java-optional)で紹介したOptionalですが、これはJavaだけでなく他の言語でも多く採用しているAPIの一つですね。むしろ、JavaのOptionalが他の言語から影響され導入されたものらしいです。今は私自身もよく使っていて、すごい便利だと思っていますが、それでも他の言語と比べたらやはり不便と思うところがあります。</p>
<p>他の言語と比べてコードが冗長であることがJavaの特徴と先に述べましたが、実際のコードではどうかをまず比較してみましょう。複雑にネストしているオブジェクトのとあるフィールドを読み、Nullだった場合はデフォルト値を返却する例を持って説明します。</p>
<h3 id=java>Java</h3>
<p>Javaのコードでは、最初のオブジェクトをOptionalでラップし、ネストされているフィールドやメソッドに対してmap()をチェーニングしていくことで次から次へとラップの対象を変えていきます。そして最後に、ターゲットのオブジェクトがNullだった場合はorElse()などのメソッドでデフォルト値を設定しますね。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#6272a4>// 元のオブジェクト
</span><span style=color:#6272a4></span>SomeClass object<span style=color:#ff79c6>;</span>

<span style=color:#6272a4>// 複雑にネストされている
</span><span style=color:#6272a4></span>Optional<span style=color:#ff79c6>.</span><span style=color:#50fa7b>ofNullable</span><span style=color:#ff79c6>(</span>object<span style=color:#ff79c6>).</span><span style=color:#50fa7b>map</span><span style=color:#ff79c6>(</span>obj<span style=color:#ff79c6>::</span>getProp1<span style=color:#ff79c6>).</span><span style=color:#50fa7b>map</span><span style=color:#ff79c6>(</span>prop1<span style=color:#ff79c6>::</span>getProp2<span style=color:#ff79c6>).</span><span style=color:#50fa7b>map</span><span style=color:#ff79c6>(</span>prop2<span style=color:#ff79c6>::</span>getProp3<span style=color:#ff79c6>).</span><span style=color:#50fa7b>orElse</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;default&#34;</span><span style=color:#ff79c6>);</span>
</code></pre></div><h3 id=c>C#</h3>
<p>言語そのものがJavaと似ているC#ですが、より若いからか、Javaと比べ進んでいる部分がよく見当たるC#です。こちらでもKotlinとコードの書き方は同じです。違うのは、オブジェクトそのものがNullになる可能性を事前に宣言しないということだけですね。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#8be9fd>object?</span>.prop1?.prop2?.prop3? ?? <span style=color:#f1fa8c>&#34;default&#34;</span>;
</code></pre></div><h3 id=javascript>JavaScript</h3>
<p>JavaScriptのOptionalもまた、C#とあまり変わらないです。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>object<span style=color:#ff79c6>?</span>.prop1<span style=color:#ff79c6>?</span>.prop2<span style=color:#ff79c6>?</span>.prop3<span style=color:#ff79c6>?</span> <span style=color:#ff79c6>??</span> <span style=color:#f1fa8c>&#34;default&#34;</span>
</code></pre></div><h3 id=swift>Swift</h3>
<p>Swiftでもそう変わりません。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift>object?.prop1?.prop2?.prop3 ?? <span style=color:#f1fa8c>&#34;default&#34;</span>
</code></pre></div><h3 id=kotlin>Kotlin</h3>
<p>Kotlinもデフォルト値指定のためのElvis opertor特有の表現を覗くと、一緒ですね。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#ff79c6>object</span><span style=color:#ff79c6>?.</span>prop1<span style=color:#ff79c6>?.</span>prop2<span style=color:#ff79c6>?.</span>prop3 <span style=color:#ff79c6>?:</span> <span style=color:#f1fa8c>&#34;default&#34;</span>
</code></pre></div><p>他の言語の例と比べて見ると、JavaのOptionalは確かに冗長な印象ですね。なので今後Optionalを言語の基本仕様として導入し、ラップをするのではなく?として表現できるようにしたらどうかという気もします。?を導入したところでコードの読みやすさを損ねるわけでもないですので。</p>
<h2 id=multiple-return-statements>Multiple Return Statements</h2>
<p>Javaの仕様ではメソッドの戻り値となれるオブジェクトは常に一つのみですが、Pythonのような言語では戻り値を複数指定することができます。もちろん、Javaの戻り値が一つという制約を乗り越えるためによくBeanやCollectionに複数のオブジェクトやデータを入れて返すことはできるのでこれはシンタックスシュガー的なものになるだけですが、それでも便利な方法があったら使いたくもなります。</p>
<h3 id=java-1>Java</h3>
<p>メソッドの処理結果として複数のデータを受け取りたい場合、Javaだと先に述べたようにBeanやCollectionを使うことになりますね。以下は戻り値が複数の数字である例です。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#6272a4>// 複数の戻り値を持つメソッド
</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> List<span style=color:#ff79c6>&lt;</span>Integer<span style=color:#ff79c6>&gt;</span> <span style=color:#50fa7b>multipleReturn</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
    <span style=color:#ff79c6>return</span> Arrays<span style=color:#ff79c6>.</span><span style=color:#50fa7b>asList</span><span style=color:#ff79c6>(</span>1<span style=color:#ff79c6>,</span> 2<span style=color:#ff79c6>);</span>
<span style=color:#ff79c6>}</span>

<span style=color:#6272a4>// 戻り値の取得
</span><span style=color:#6272a4></span>List<span style=color:#ff79c6>&lt;</span>Integer<span style=color:#ff79c6>&gt;</span> data <span style=color:#ff79c6>=</span> multipleReturn<span style=color:#ff79c6>();</span>
</code></pre></div><h3 id=c-1>C#</h3>
<p>C#でもJavaと似たようなやり方で複数のデータを取得することができますね。実際はref/outパラメータを使ったり、structやclassを使う方法もあるらしいですが、Javaと比べより便利ではないかと思うのはTupleを使う場合です。C#のバージョンによって書き方が違っていて、昔の書き方ではJavaでCollectionを使うのとあまり変わらないものの、新しい書き方ではかなり便利なものとなっています。以下はその二つの例のコードです。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#6272a4>// 複数の戻り値を持つメソッド(7以前)
</span><span style=color:#6272a4></span><span style=color:#ff79c6>public</span> Tuple&lt;<span style=color:#8be9fd>int</span>, <span style=color:#8be9fd>int</span>&gt; oldMultipleReturn()
{
    <span style=color:#ff79c6>return</span> Tuple.Create(<span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>2</span>);
}

<span style=color:#6272a4>// オブジェクトとして取得
</span><span style=color:#6272a4></span><span style=color:#8be9fd>var</span> result = oldMultipleReturn();

<span style=color:#6272a4>// 複数の戻り値を持つメソッド(7以後)
</span><span style=color:#6272a4></span><span style=color:#ff79c6>public</span> (<span style=color:#8be9fd>int</span>, <span style=color:#8be9fd>int</span>) newMultipleReturn()
{
    <span style=color:#ff79c6>return</span> (<span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>2</span>);
}

<span style=color:#6272a4>// 変数として取得
</span><span style=color:#6272a4></span>(<span style=color:#8be9fd>int</span> one, <span style=color:#8be9fd>int</span> two) = newMultipleReturn();
</code></pre></div><h3 id=python>Python</h3>
<p>Pythonの例では、7以後のC#と似たような感覚でコードを書けます。オブジェクト(tuple)として戻り値を全部取得するか、個別の変数として取得するか両方一つのfunctionでできるのがより便利な気もしますね。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#6272a4># 複数の戻り値を持つfunction</span>
<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>multiple_return</span>():
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>2</span>

<span style=color:#6272a4># 個別の戻り値を取得</span>
a, b <span style=color:#ff79c6>=</span> multiple_return()
<span style=color:#8be9fd;font-style:italic>print</span>(a) <span style=color:#6272a4># 1</span>

<span style=color:#6272a4># 戻り値をtupleとして全取得</span>
d <span style=color:#ff79c6>=</span> multiple_return()
<span style=color:#8be9fd;font-style:italic>print</span>(d) <span style=color:#6272a4># (1, 2)</span>
</code></pre></div><h3 id=javascript-1>JavaScript</h3>
<p>ES6から導入された書き方ではPythonと似たようなコードで複数の戻り値を取得できます。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#6272a4>// 複数の戻り値を持つfunction
</span><span style=color:#6272a4></span>funtion multipleReturn() {
    <span style=color:#ff79c6>return</span> {
        first<span style=color:#ff79c6>:</span> <span style=color:#bd93f9>1</span>,
        second<span style=color:#ff79c6>:</span> <span style=color:#bd93f9>2</span>
    }
}

<span style=color:#6272a4>// 個別の戻り値を取得
</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>var</span> (first, second) <span style=color:#ff79c6>=</span> multipleReturn()
</code></pre></div><h3 id=swift-1>Swift</h3>
<p>SwiftはやはりOptionalと同じく、JavaScriptとあまり変わりません。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#6272a4>// 複数の戻り値を持つfunction</span>
<span style=color:#8be9fd;font-style:italic>func</span> <span style=color:#50fa7b>multipleReturn</span>() -&gt; (<span style=color:#8be9fd;font-style:italic>Int</span>, <span style=color:#8be9fd;font-style:italic>Int</span>) {
    <span style=color:#ff79c6>return</span> (<span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>2</span>)
}

<span style=color:#6272a4>// 個別の戻り値を取得</span>
<span style=color:#8be9fd;font-style:italic>let</span> (first, second) = multipleReturn()
</code></pre></div><h3 id=kotlin-1>Kotlin</h3>
<p>KotlinではPairかTripleなどがあり、使い方は簡単です。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#6272a4>// 複数の戻り値を持つfunction
</span><span style=color:#6272a4></span><span style=color:#ff79c6>fun</span> <span style=color:#50fa7b>multipleReturn</span>(): Pair&lt;Int, Int&gt; {
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span> to <span style=color:#bd93f9>2</span>
}

<span style=color:#6272a4>// 個別の戻り値を取得
</span><span style=color:#6272a4></span><span style=color:#ff79c6>val</span> (first, second) = multipleReturn()
</code></pre></div><p>Javaでのコードの書き方の方がメソッドの役割をわかりやすいというメリットはありますが、戻り値のオブジェクトやデータをそのまま変数として使えるという面ではPythonのやり方がより便利ですね。このように複数の戻り値を持つメソッドを定義できるのは現代プログラミング言語ならどれもが持っている機能のようです。Javaにもいつかは導入されるのでしょうか？</p>
<h2 id=引数の種類をor指定>引数の種類をor指定</h2>
<p>たまに、一つのメソッドで引数の型を複数指定できたら便利ではないだろうかと思うことがあります。Javaではこれをオーバーロードで実現していますね。</p>
<h3 id=java-2>Java</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>doSomething</span><span style=color:#ff79c6>(</span>String value<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
    <span style=color:#6272a4>// Stringの場合の処理
</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>

<span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>doSomething</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> value<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
    <span style=color:#6272a4>// intの場合の処理
</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
</code></pre></div><p>もちろん、引数の型をObjectとして宣言し、内部ではinstansofを使って判定することもできます。しかし、前者ならやりたいことに比べコードの量が増えすぎる問題がありますし、後者なら意図した型以外のObjectが渡された場合の挙動がおかしくなる可能性もあります。</p>
<h3 id=typescript>TypeScript</h3>
<p>TypeScriptでは、これを簡単に引数のタイプを複数指定できるようにすることで解決しています。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#8be9fd;font-style:italic>function</span> checkString(v: <span style=color:#8be9fd>string</span> <span style=color:#ff79c6>|</span> <span style=color:#8be9fd>number</span>) {
    <span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>typeof</span> v <span style=color:#ff79c6>===</span> <span style=color:#f1fa8c>&#34;string&#34;</span>) {
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>true</span>
    }
    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>false</span>
}
</code></pre></div><p>これまで引数の種類だけ違う場合はオーバーロードして、共通処理だけprivateメソッドで書いていましたが、これならよりコードを簡単に把握できそうですね。ぜひ導入して欲しい機能の一つです。</p>
<h2 id=ternary-operator-with-throw>Ternary Operator with Throw</h2>
<p>結果が二択しかない場合は、なるべくifより三項演算子を使った方がコードも短くなり便利と思います。しかし、Javaの三項演算子では例外を投げることができません。条件式に当てはまらない場合はどうしても以下のようなコードを書くしかないです。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#6272a4>// xが0だとnumberも0で、0ではなかった場合は例外とする
</span><span style=color:#6272a4></span><span style=color:#8be9fd>int</span> number <span style=color:#ff79c6>=</span> x <span style=color:#ff79c6>-&gt;</span> <span style=color:#ff79c6>{</span>
    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span>x <span style=color:#ff79c6>==</span> 0<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
        <span style=color:#ff79c6>return</span> x<span style=color:#ff79c6>;</span>
    <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>else</span> <span style=color:#ff79c6>{</span>
        <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> RuntimeException<span style=color:#ff79c6>();</span>
    <span style=color:#ff79c6>}</span>
<span style=color:#ff79c6>}</span>
</code></pre></div><p>無理やり三項演算子で例外を投げようとしたら、以下のような方法はありますね。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#6272a4>// Genericな戻り値を持っていて、例外を投げるだけのメソッド
</span><span style=color:#6272a4></span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#ff79c6>&lt;</span>T<span style=color:#ff79c6>&gt;</span> T <span style=color:#50fa7b>throwSomeException</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
    <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> RuntimeException<span style=color:#ff79c6>();</span>
<span style=color:#ff79c6>}</span>

<span style=color:#6272a4>// elseでメソッドを呼ぶ
</span><span style=color:#6272a4></span><span style=color:#8be9fd>int</span> number <span style=color:#ff79c6>=</span> x <span style=color:#ff79c6>==</span> 0 <span style=color:#ff79c6>?</span> x <span style=color:#ff79c6>:</span> throwSomeException<span style=color:#ff79c6>();</span>
</code></pre></div><p>個人的にif文は二択しかない結果のために使うのはスペースの無駄遣いと思いますし、無理やりメソッドを作ってまで三項演算子を使う必要はないので、三項演算子でelseの場合には単純に例外を投げられるといいな、と思っていました。そして調べてみると、他の言語ではそれができるようです。</p>
<h3 id=c-2>C#</h3>
<p>C#では、二つのやり方があります。まず7以前だと、elseの場合に例外を投げるFuncを実行させることで実現できます。そして7以後では普通に三項演算子でthrowできるようです。まさに私が望んでいた形ですね。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#6272a4>// 7以前
</span><span style=color:#6272a4></span><span style=color:#8be9fd>int</span> number = x == <span style=color:#bd93f9>0</span> ? x : <span style=color:#ff79c6>new</span> Func&lt;<span style=color:#8be9fd>int</span>&gt;(() =&gt; { <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> Exception(); })();

<span style=color:#6272a4>// 7以後
</span><span style=color:#6272a4></span><span style=color:#8be9fd>int</span> number = x == <span style=color:#bd93f9>0</span> ? x : <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> Exception();
</code></pre></div><h3 id=kotlin-2>Kotlin</h3>
<p>Kotlinでは三項演算子がなく、if-elseを使うことになるということだけで、簡単な形になっています。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#ff79c6>val</span> i = <span style=color:#ff79c6>if</span> (x <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>) x <span style=color:#ff79c6>else</span> <span style=color:#ff79c6>throw</span> Exception(<span style=color:#f1fa8c>&#34;error&#34;</span>)
</code></pre></div><h3 id=javascript-2>JavaScript</h3>
<p>JavaScriptでは、7以前のC#と似た形で例外を投げることができます。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#8be9fd;font-style:italic>var</span> number <span style=color:#ff79c6>=</span> (x <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>?</span> x <span style=color:#ff79c6>:</span> (<span style=color:#8be9fd;font-style:italic>function</span>() { <span style=color:#ff79c6>throw</span> <span style=color:#f1fa8c>&#34;error&#34;</span> }());
</code></pre></div><p>わざわざ関数を実行してまで三項演算子で例外を投げたくはないですが、こういうやり方があるということがわかっただけでもかなり興味深いですね。JavaにもC#の7以後のような書き方ができるといいな、と思います。</p>
<h2 id=アクセス修飾子の拡張>アクセス修飾子の拡張</h2>
<p>Javaでのアクセス修飾子は、public・private・protectedをよく使っています。しかし、自作ライブラリーを作る場合はpublicとprivateの中間的なものもあって欲しいな、と思う時もあります。例えばJarにまとめた時、Jar以外ではアクセスできないようなアクセス制限をかけられるようなものですね。</p>
<p>Java 9からモジュールが導入されましたが、自分が経験した問題もあるのでなるべくモジュールを使いたくはないなと思っているので…同じプロジェクトの中ならパッケージが違ってもアクセスできるような修飾子があったらいいな、と思います。また、protectedならサブパッケージでも参照できるなど。同じモジュール内でのみのアクセス修飾子はC#とSwift、KotlinでInternalとして提供しているので、Javaにも導入されるといいですね。</p>
<h2 id=最後に>最後に</h2>
<p>最近のJavaの更新履歴をみると、続々と便利な機能が導入され続けています。特に14では、recordでLombokの<code>@Data</code>と同じ機能を持つクラス宣言ができるようになるらしいです。次のLTS版は17なので、まだ十分色々と改善される余地はありますね。1.8でも便利な機能は多いですが、これからもどんどん他の言語の良い点を吸収して変転できるといいなと思います。</p>
<p>また、こうやって他の言語ではどうしているかを調べてみるのも良い勉強となりました。特にTypeScriptは最近注目している言語なので、機会があれば経験してみて、Javaとの比較もしてみたいものですね。では、また！</p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/java/>java</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/posts/java-enter-to-17/>
<div class=article-image>
<img src=/../../images/java.jpg loading=lazy data-key data-hash=/../../images/java.jpg>
</div>
<div class=article-details>
<h2 class=article-title>Java 17は何が変わったか</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/posts/java-string-concat-and-split/>
<div class=article-image>
<img src=/../../images/java.jpg loading=lazy data-key data-hash=/../../images/java.jpg>
</div>
<div class=article-details>
<h2 class=article-title>今更な文字列操作の話</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/posts/java-file-copy/>
<div class=article-image>
<img src=/../../images/java.jpg loading=lazy data-key data-hash=/../../images/java.jpg>
</div>
<div class=article-details>
<h2 class=article-title>今更なI/Oの話</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/posts/java-new-methods-from-9-to-11/>
<div class=article-image>
<img src=/../../images/java.jpg loading=lazy data-key data-hash=/../../images/java.jpg>
</div>
<div class=article-details>
<h2 class=article-title>9からの新メソッドめぐり</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/posts/java-collection-loop/>
<div class=article-image>
<img src=/../../images/java.jpg loading=lazy data-key data-hash=/../../images/java.jpg>
</div>
<div class=article-details>
<h2 class=article-title>今更なループの話</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2019 -
2022 Korean-man in Tokyo
</section>
<section class=powerby>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.7.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#optional表記の改善>Optional表記の改善</a>
<ol>
<li><a href=#java>Java</a></li>
<li><a href=#c>C#</a></li>
<li><a href=#javascript>JavaScript</a></li>
<li><a href=#swift>Swift</a></li>
<li><a href=#kotlin>Kotlin</a></li>
</ol>
</li>
<li><a href=#multiple-return-statements>Multiple Return Statements</a>
<ol>
<li><a href=#java-1>Java</a></li>
<li><a href=#c-1>C#</a></li>
<li><a href=#python>Python</a></li>
<li><a href=#javascript-1>JavaScript</a></li>
<li><a href=#swift-1>Swift</a></li>
<li><a href=#kotlin-1>Kotlin</a></li>
</ol>
</li>
<li><a href=#引数の種類をor指定>引数の種類をor指定</a>
<ol>
<li><a href=#java-2>Java</a></li>
<li><a href=#typescript>TypeScript</a></li>
</ol>
</li>
<li><a href=#ternary-operator-with-throw>Ternary Operator with Throw</a>
<ol>
<li><a href=#c-2>C#</a></li>
<li><a href=#kotlin-2>Kotlin</a></li>
<li><a href=#javascript-2>JavaScript</a></li>
</ol>
</li>
<li><a href=#アクセス修飾子の拡張>アクセス修飾子の拡張</a></li>
<li><a href=#最後に>最後に</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>