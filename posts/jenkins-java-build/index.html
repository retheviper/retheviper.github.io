<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="今回はJenkinsで一つのJobを生成することまでやりたいと思います。まず前回も書きましたが、私に要求されたタスクは次のようなことです。「"><title>JenkinsでJavaプロジェクトをビルドする</title><link rel=canonical href=https://retheviper.github.io/posts/jenkins-java-build/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="JenkinsでJavaプロジェクトをビルドする"><meta property="og:description" content="今回はJenkinsで一つのJobを生成することまでやりたいと思います。まず前回も書きましたが、私に要求されたタスクは次のようなことです。「"><meta property="og:url" content="https://retheviper.github.io/posts/jenkins-java-build/"><meta property="og:site_name" content="Korean-man in Tokyo"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="ci/cd"><meta property="article:tag" content="jenkins"><meta property="article:published_time" content="2019-05-26T00:00:00+00:00"><meta property="article:modified_time" content="2019-05-26T00:00:00+00:00"><meta property="og:image" content="https://retheviper.github.io/images/jenkins.jpg"><meta name=twitter:title content="JenkinsでJavaプロジェクトをビルドする"><meta name=twitter:description content="今回はJenkinsで一つのJobを生成することまでやりたいと思います。まず前回も書きましたが、私に要求されたタスクは次のようなことです。「"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://retheviper.github.io/images/jenkins.jpg"><link rel="shortcut icon" href=true><script async src="https://www.googletagmanager.com/gtag/js?id=G-BYJBEJB6DX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BYJBEJB6DX",{anonymize_ip:!1})}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu768313a802c015f07dded3abd3d4245d_264018_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>👋</span></figure><div class=site-meta><h1 class=site-name><a href=/>Korean-man in Tokyo</a></h1><h2 class=site-description>一人前になりたいです</h2></div></header><ol class=social-menu><li><a href=https://www.credly.com/users/youngbin-kim.6d7122f1/badges target=_blank title=Certificates rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-certificate" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="15" cy="15" r="3"/><path d="M13 17.5V22l2-1.5 2 1.5v-4.5"/><path d="M10 19H5a2 2 0 01-2-2V7c0-1.1.9-2 2-2h14a2 2 0 012 2v10a2 2 0 01-1 1.73"/><line x1="6" y1="9" x2="18" y2="9"/><line x1="6" y1="12" x2="9" y2="12"/><line x1="6" y1="15" x2="8" y2="15"/></svg></a></li><li><a href=https://github.com/retheviper target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/%E8%8B%B1%E6%96%8C-%E9%87%91-6736ba194/ target=_blank title=LinkedIn rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://retheviper.github.io/index.xml target=_blank title=RSS rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#それでjobとは>それでJobとは？</a></li><li><a href=#jobを生成する>Jobを生成する</a></li><li><a href=#gitのレポジトリを設定>Gitのレポジトリを設定</a></li><li><a href=#ビルドしてみる1>ビルドしてみる(1)</a></li><li><a href=#gradleの設定>Gradleの設定</a></li><li><a href=#ビルドしてみる2>ビルドしてみる(2)</a></li><li><a href=#最後に>最後に</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/jenkins-java-build/><img src=/../../images/jenkins.jpg loading=lazy alt="Featured image of post JenkinsでJavaプロジェクトをビルドする"></a></div><div class=article-details><header class=article-category><a href=/categories/jenkins/ style=background-color:#2a9d8f;color:#fff>jenkins</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/jenkins-java-build/>JenkinsでJavaプロジェクトをビルドする</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>May 26, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><p>今回はJenkinsで一つのJobを生成することまでやりたいと思います。まず前回も書きましたが、私に要求されたタスクは次のようなことです。「GitにSpring Bootのアプリケーションがあるので、それをビルドするJobを作って欲しい」とのこと。リポジトリを覗き、JavaとGradleはインストールしたので早速Jobの生成に取り掛かることにしました。</p><p>今回は当時と似たような環境を作るためにあらかじめSpring Bootプロジェクトを作成してGitにアップロードしています。</p><h2 id=それでjobとは>それでJobとは？</h2><p>Jenkinsを使う理由は、このJobのためです。Jobは<code>自動化されたタスク</code>で、実行の条件から頻度、タスクの内容を組み込むことができます。例えばGitのリポジトリに誰かがPushしたらJobを実行するように設定できるし、実行したら自動的にGitをPullするように設定できるということです。</p><p>なのでJenkinsをサーバ上で起動しておいて、必要に応じてJobを組んでおけば大変手間が省けるという話は全てこのJobのおかげだと言えます。今回はこのJobの生成の手順から説明しましょう。</p><h2 id=jobを生成する>Jobを生成する</h2><p>Jenkinsのメインページに入ります。何もJobがない状態なので、メイン画面に<code>create new jobs</code>というリンクがあることを確認できます。Jobが無い場合はこちらでもJobを生成することができます。しかし何かしらのJobがある場合は、左のメニューで<code>New item</code>をクリックすれば新しいJobの生成画面に移行します。どちらかをクリックします。</p><p><img src=/posts/jenkins-java-build/jenkins_mainpage.png width=1280 height=706 srcset="/posts/jenkins-java-build/jenkins_mainpage_hu31ccc37630512f0e2e6d3a4accbb406d_76051_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_mainpage_hu31ccc37630512f0e2e6d3a4accbb406d_76051_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Mainpage" class=gallery-image data-flex-grow=181 data-flex-basis=435px></p><p><code>Enter an item name</code>でJobの名前を指定します。また、下にはどんなJobを生成するかに対するいくつかのテンプレートがあります。ここでは<code>Freestyle project</code>を選びます。ちなみに、Job生成時に指定した名前と同じ名のフォルダがJenkinsの<code>Workspace</code>というフォルダの下に生成されるので、なるべく半角英文字・スペースなしで生成することをお勧めします。</p><p><img src=/posts/jenkins-java-build/jenkins_createjob.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_createjob_hu81765b90c78b7229947de03fd66b9755_109778_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_createjob_hu81765b90c78b7229947de03fd66b9755_109778_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Create Job" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>Jobの名前とテンプレートを選んだなら、<code>Ok</code>を押してJobを生成します。</p><p><img src=/posts/jenkins-java-build/jenkins_jobmain.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_jobmain_hu6af9b1671c9e5d5400baed1eaa06d07f_75401_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_jobmain_hu6af9b1671c9e5d5400baed1eaa06d07f_75401_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Job Main" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>ここがJob設定のメイン画面です。画面の最上段にある各タブの機能は以下のようになります。</p><ul><li><code>General</code>: Job全般の設定。Jobの説明を記述したり（どんなタスクなのかなど）、ビルド<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>時以前のビルドを削除するかなどの設定ができます。</li><li><code>Source Code Management</code>: バージョン管理に関する設定です。GitとSubversionに対応しています。今回はGitを使うことになりますね。</li><li><code>Build Triggers</code>: Jobをどう実行するかに対するトリガーの設定です。リモートからURLを通じた実行になるか、定期的に実行するかなどの設定ができます。</li><li><code>Build Environment</code>: Jobのビルド時に使われる環境に関しての設定です。基本的にJobはWorkspaceという空間を占め、ビルド時に使われたファイルなどは全てそのフォルダに保存されます。基本パスは<code>/var/lib/jenkins/workspace/[生成したJobの名前]</code>となります。</li><li><code>Build</code>: Jobのビルド時のアクション（タスク）を指定します。ここで主な処理が行われます。</li><li><code>Post-build Actions</code>: Jobのビルドが終わった後に遂行するアクションを指定します。他のJobをビルドするなどの行動が指定できます。</li></ul><p>各タブはどんなプラグインをインストールしたかによって指定できる動作の項目が増えることがあります。また違うポストで扱うかもしれませんが、例えば<code>Publish over SSH</code>という</p><h2 id=gitのレポジトリを設定>Gitのレポジトリを設定</h2><p>それでは本格的に今回のタスクを作ってみましょう。まずGitからJavaのコードを持ってくる必要があるので、<code>Source Code Management</code>からGitを選択します。</p><p><img src=/posts/jenkins-java-build/jenkins_gitconfigure.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gitconfigure_hu6af9b1671c9e5d5400baed1eaa06d07f_76805_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gitconfigure_hu6af9b1671c9e5d5400baed1eaa06d07f_76805_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkin Git Config" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p><code>Repository URL</code>にはGitのリポジトリを入力します。最初何も入力されてない時は接続エラーが出ていますが、URLを入力すると自動的にリポジトリへの接続を試し、問題がないとエラーは消えます。また、<code>Credentials</code>から接続するIDなどの認証情報を選択します。最初は何もないので、<code>Add</code>をクリックし新しい認証情報を入力しましょう。</p><p>今の所、私の作ったリポジトリはブランチが一つしかないのですが、もし特定のブランチだけをPullしたい場合は<code>Branches to Build</code>のフィールドにブランチ名を入力することで指定できます。</p><p><img src=/posts/jenkins-java-build/jenkins_gitcredential.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gitcredential_hu6af9b1671c9e5d5400baed1eaa06d07f_72036_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gitcredential_hu6af9b1671c9e5d5400baed1eaa06d07f_72036_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Git Credential" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>他はデフォルト値で、GitのIDとパスワードだけを入力して<code>Add</code>を押せば終了。こちらで入力した認証情報は全域設定なので、他のJobでも使えます。</p><p>認証情報まで無事入力ができたら、<code>Save</code>を押して一旦作業を保存しましょう。そうすると、以下のような画面に戻ります。</p><p><img src=/posts/jenkins-java-build/jenkins_jobsaved.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_jobsaved_hu327225b84382fef948a721bebc266b3c_86850_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_jobsaved_hu327225b84382fef948a721bebc266b3c_86850_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Job Saved" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><h2 id=ビルドしてみる1>ビルドしてみる(1)</h2><p>これまででGitからPullするというタスクの設定は終わっています。ちゃんとタスクが意図通りに動作するかを検証するため、ビルドしてみましょう。左のメニューから<code>Build now</code>をクリックすると、しばらくして左下の<code>Build History</code>という領域に初めてのビルドが表示されることを確認できます。<code>#1</code>の所に青い丸が付いていたらビルドが成功したという意味です。不安定だったら黄色、失敗だと赤の丸がつくのでビルドの状態を確認できます。</p><p>ビルドに成功したら、<code>#1</code>をクリックしてビルドの詳細を確認します。以下のような画面が現れます。</p><p><img src=/posts/jenkins-java-build/jenkins_gitjob1.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gitjob1_hu40bf41d553c3c7b27957477f31c192a4_95353_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gitjob1_hu40bf41d553c3c7b27957477f31c192a4_95353_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Git Job" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>実際のビルドでどんな処理が行われたかを確認するには、左のメニューから<code>Console Output</code>をクリックします。Linuxのコンソールのような画面で表示されます。</p><p><img src=/posts/jenkins-java-build/jenkins_gitjob2.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gitjob2_hu2cb666f3f9a4b3bbfe2881a91e6a8e20_167580_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gitjob2_hu2cb666f3f9a4b3bbfe2881a91e6a8e20_167580_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Git Job 2" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>ちゃんと指定した通り、Gitのリポジトリ（ブランチはマスター）からPullしてきたことを確認できます。コミットメッセージまで出力してくれてますね。</p><p>Linuxのコンソールから<code>/var/lib/jenkins/workspace/</code>配下のフォルダを直接確認することもできますが、JenkinsのWebコンソールからもJobのワークスペースを確認することができます。左のメニューで<code>Back to Project</code>をクリックし、<code>Workspace</code>をクリックすると以下のような画面が現れます。</p><p><img src=/posts/jenkins-java-build/jenkins_gitjob3.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gitjob3_hu25c35be67ddd05e54b4ec179db2805e7_97080_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gitjob3_hu25c35be67ddd05e54b4ec179db2805e7_97080_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Git Job 3" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>実際GitのPullが正しく行われ、フォルダとファイルが生成されたことをこちらで確認できます。</p><h2 id=gradleの設定>Gradleの設定</h2><p>それでは次に、Gradleによるビルドの設定です。歯車のアイコンの付いた<code>Configure</code>をクリックし、Jobの設定画面に戻ります。GradleでJarファイルをビルドするのが目的なので、GitでPullした後のタスクになりますね。</p><p><code>Build</code>のタブに移動し、<code>Add build step</code>をクリック、ドロップダウンメニューから<code>Invoke Gradle script</code>を選択します。そして<code>Advanced...</code>をクリックしましょう。</p><p><img src=/posts/jenkins-java-build/jenkins_gradleconfigure1.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gradleconfigure1_hu6af9b1671c9e5d5400baed1eaa06d07f_61115_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gradleconfigure1_hu6af9b1671c9e5d5400baed1eaa06d07f_61115_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Gradle Config" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>ここで<code>Invoke Gradle</code>には前回のポストで入れといたGraldeをドロップダウンメニューで選択します。</p><p>そして次に、<code>Use Gradle Wrapper</code>の下のTasksに<code>bootJar</code>を入力します。このコマンドで実行可能なJarファイルが生成されます。また、<code>bootJar</code>コマンドでは<code>build.gradle</code>のパスを確保する必要があるので（GraldeがWorkspaceのJob名のフォルダで実行されるので、その同じパスに<code>build.gradle</code>がある場合でないと必須です）下の<code>Build File</code>にちゃんとパスを書きます。</p><p>もちろんGradleのコマンドではビルドファイルのパスを指定するオプションもあるので、<code>bootJar</code>だけでなく<code>-b SpringBootDemo/build.gradle bootJar</code>のようにコマンドを書いても同じくビルドはできます。</p><p><img src=/posts/jenkins-java-build/jenkins_gradleconfigure2.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gradleconfigure2_hu6af9b1671c9e5d5400baed1eaa06d07f_68681_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gradleconfigure2_hu6af9b1671c9e5d5400baed1eaa06d07f_68681_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Gradle Config 2" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>これでGradleでのビルド設定は終わり。次にGitの時と同じく、検証してみます。</p><h2 id=ビルドしてみる2>ビルドしてみる(2)</h2><p>ビルドの手順もGitの時と変わりません。<code>Build Now</code> → <code>#2</code> → <code>Console Output</code>の手順でビルドのコンソール出力を確認します。</p><p><img src=/posts/jenkins-java-build/jenkins_gradlebuild.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gradlebuild_hu07cd78540d117cbf38e2ea73df20238f_169637_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gradlebuild_hu07cd78540d117cbf38e2ea73df20238f_169637_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Gradle Build" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>無事Gradleでのビルドが終わりました。それではJarファイルがちゃんとできたか確認しましょう。</p><p><img src=/posts/jenkins-java-build/jenkins_gradlebuildjar.png width=1440 height=838 srcset="/posts/jenkins-java-build/jenkins_gradlebuildjar_huca48090c0824467aa115c2dd28ee5015_100508_480x0_resize_box_3.png 480w, /posts/jenkins-java-build/jenkins_gradlebuildjar_huca48090c0824467aa115c2dd28ee5015_100508_1024x0_resize_box_3.png 1024w" loading=lazy alt="Jenkins Gradle Build JAR" class=gallery-image data-flex-grow=171 data-flex-basis=412px></p><p>ちゃんと<code>build/libs</code>フォルダにJarファイルができたことを確認できます。</p><h2 id=最後に>最後に</h2><p>Jenkinsでできることはこれだけではありません。ビルド終了後にデプロイのJobを作り、そのJobを実行するように連携もできれば、JUnitとの連携でテストを行えうように設定も可能です。なので今後のポストでは出来上がったJarファイルをテストしデプロイする方法について書きたいと思います。</p><p>また、Jobの設定で<code>Build Environment</code>タブにある<code>Delete workspace before build starts</code>というオプションをチェックしておくのも良いと思います。Jobの実行時にWorkspaceフォルダをまず掃除してからタスクを実行していきますが、これによって前回のビルドで生成されたファイルによる異常動作を防げられますので。</p><p>仕事で触れた部分が少ないのでまだ私も全部の機能を試した訳ではありませんが、Jenkinsは各種プラグインとその組み合わせによって可能性は無限大に違いのではないかと思うくらい良いツールです。また色々研究したいものですね。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>JenkinsのJobにおいてのビルドは、Jobのバージョンに近いイメージです。特定時点のJobを設定〜実行までの単位をビルドと言います。Javaのビルドとは少し違う概念なので混同しないようにしましょう。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer class=article-footer><section class=article-tags><a href=/tags/ci/cd/>ci/cd</a>
<a href=/tags/jenkins/>jenkins</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/jenkins-pipeline/><div class=article-image><img src=/../../images/jenkins.jpg loading=lazy data-key data-hash=/../../images/jenkins.jpg></div><div class=article-details><h2 class=article-title>Jenkins Pipelineを使う</h2></div></a></article><article class=has-image><a href=/posts/jenkins-java-deploy/><div class=article-image><img src=/../../images/jenkins.jpg loading=lazy data-key data-hash=/../../images/jenkins.jpg></div><div class=article-details><h2 class=article-title>JenkinsでJarファイルをデプロイする</h2></div></a></article><article class=has-image><a href=/posts/jenkins-automation-3/><div class=article-image><img src=/../../images/jenkins.jpg loading=lazy data-key data-hash=/../../images/jenkins.jpg></div><div class=article-details><h2 class=article-title>Jenkinsで何もかも楽にしたい(3)</h2></div></a></article><article class=has-image><a href=/posts/jenkins-automation-2/><div class=article-image><img src=/../../images/jenkins.jpg loading=lazy data-key data-hash=/../../images/jenkins.jpg></div><div class=article-details><h2 class=article-title>Jenkinsで何もかも楽にしたい(2)</h2></div></a></article><article class=has-image><a href=/posts/jenkins-automation-1/><div class=article-image><img src=/../../images/jenkins.jpg loading=lazy data-key data-hash=/../../images/jenkins.jpg></div><div class=article-details><h2 class=article-title>Jenkinsで何もかも楽にしたい(1)</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2019 -
2023 Korean-man in Tokyo</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.20.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>