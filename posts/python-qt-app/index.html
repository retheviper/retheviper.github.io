<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="最近友人がYoutubeのチャンネルを始めました。主に海外のYoutubeのチャンネルにアップされてあるドラマのメイキングやインタビュー動画"><title>PyQtで字幕翻訳ツールを作ってみた</title>
<link rel=canonical href=https://retheviper.github.io/posts/python-qt-app/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="PyQtで字幕翻訳ツールを作ってみた"><meta property="og:description" content="最近友人がYoutubeのチャンネルを始めました。主に海外のYoutubeのチャンネルにアップされてあるドラマのメイキングやインタビュー動画"><meta property="og:url" content="https://retheviper.github.io/posts/python-qt-app/"><meta property="og:site_name" content="Korean-man in Tokyo"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="python"><meta property="article:tag" content="qt"><meta property="article:published_time" content="2022-05-01T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-01T00:00:00+00:00"><meta property="og:image" content="https://retheviper.github.io/images/python.jpg"><meta name=twitter:title content="PyQtで字幕翻訳ツールを作ってみた"><meta name=twitter:description content="最近友人がYoutubeのチャンネルを始めました。主に海外のYoutubeのチャンネルにアップされてあるドラマのメイキングやインタビュー動画"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://retheviper.github.io/images/python.jpg"><link rel="shortcut icon" href=/favicon.ico><link rel=icon href=/favicon/favicon.ico><link rel=mask-icon href=safari-pinned-tab.svg color=black><link rel=manifest href=/favicon/manifest.json><script async src="https://www.googletagmanager.com/gtag/js?id=G-BYJBEJB6DX"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BYJBEJB6DX",{anonymize_ip:!1})}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu768313a802c015f07dded3abd3d4245d_264018_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>👋</span></figure><div class=site-meta><h1 class=site-name><a href=/>Korean-man in Tokyo</a></h1><h2 class=site-description>一人前になりたいです</h2></div></header><ol class=social-menu><li><a href=https://www.credly.com/users/youngbin-kim.6d7122f1/badges target=_blank title=Certificates rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-certificate" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="15" cy="15" r="3"/><path d="M13 17.5V22l2-1.5 2 1.5v-4.5"/><path d="M10 19H5a2 2 0 01-2-2V7c0-1.1.9-2 2-2h14a2 2 0 012 2v10a2 2 0 01-1 1.73"/><line x1="6" y1="9" x2="18" y2="9"/><line x1="6" y1="12" x2="9" y2="12"/><line x1="6" y1="15" x2="8" y2="15"/></svg></a></li><li><a href=https://github.com/retheviper target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/%E8%8B%B1%E6%96%8C-%E9%87%91-6736ba194/ target=_blank title=LinkedIn rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://retheviper.github.io/index.xml target=_blank title=RSS rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#設計>設計</a><ol><li><a href=#字幕>字幕</a></li><li><a href=#言語翻訳api>言語翻訳API</a></li><li><a href=#技術>技術</a></li></ol></li><li><a href=#コード>コード</a><ol><li><a href=#ファイル読み込み>ファイル読み込み</a></li><li><a href=#翻訳apiの呼び出し>翻訳APIの呼び出し</a></li><li><a href=#ファイルの保存>ファイルの保存</a></li><li><a href=#ファイルドロップダウン>ファイルドロップダウン</a></li><li><a href=#ファイル削除>ファイル削除</a></li><li><a href=#言語選択>言語選択</a></li><li><a href=#翻訳ボタン>翻訳ボタン</a></li></ol></li><li><a href=#改善したい>改善したい</a><ol><li><a href=#テキストをまとめて翻訳する>テキストをまとめて翻訳する</a></li><li><a href=#プログレスバーを追加する>プログレスバーを追加する</a></li><li><a href=#ボタンの非活性化>ボタンの非活性化</a></li></ol></li><li><a href=#最後に>最後に</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/python-qt-app/><img src=/../../images/python.jpg loading=lazy alt="Featured image of post PyQtで字幕翻訳ツールを作ってみた"></a></div><div class=article-details><header class=article-category><a href=/categories/python/ style=background-color:#2a9d8f;color:#fff>python</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/python-qt-app/>PyQtで字幕翻訳ツールを作ってみた</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>May 01, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>11 minute read</time></div></footer></div></header><section class=article-content><p>最近友人がYoutubeのチャンネルを始めました。主に海外のYoutubeのチャンネルにアップされてあるドラマのメイキングやインタビュー動画などに字幕をつけて配信するというチャンネルですが、そこで毎回字幕を作るのはかなりめんどくさい作業なので、ちょっとしたコマンドaliasとして作成して提供することにしました。元の動画には原語の字幕がついていて、編集用ツールでそれを読み込むことができるらしいので動画だけでなく字幕もダウンロードするコマンドを作成しています。これなら翻訳した字幕ファイルを編集ツールで読み込んで使えるので、かなり作業量が減りました。</p><p>ただ、チャンネルの登録者数が増えながら、中には色々な国からの人もいたようで、友人から「自動翻訳を使って多国語の字幕を追加できる手段が欲しい」という依頼が来ました。簡単なツールを作れば良さそうだったので、早速ツールを作って公開することになったので、今回はそのツールを作った話をしたいと思います。</p><h2 id=設計>設計</h2><p>まずは友人の要望と、技術スタック、アプリの基本設計を行いました。といっても、複雑なことはあまりしたくなかったので、（友人の）やりたいことをベースに、自分がやってみたいことを混ぜたくらいのレベル感です。</p><h3 id=字幕>字幕</h3><p><a class=link href=https://youtube-dl.org/ target=_blank rel=noopener>youtube-dl</a>や<a class=link href=https://github.com/yt-dlp/yt-dlp target=_blank rel=noopener>yt-dlp</a>を使ってYouTubeの動画をダウンロードする際、元の動画に字幕がついてある場合はオプションを追加することで字幕も落とせます。Youtubeで字幕をダウンロードすると、多くの場合ファイル形式が<a class=link href=https://developer.mozilla.org/ja/docs/Web/API/WebVTT_API target=_blank rel=noopener>WebVTT</a>になるので、とりあえず<code>.vtt</code>形式のファイルに対応する必要があると思いました。他のフォーマットまで対応するには時間がかかりそうだったので、まずはこれのみにします。</p><p>幸い、実際の字幕ファイルを落としてみたところ、フォーマットはシンプルで(<a class=link href=https://ja.wikipedia.org/wiki/SubRip target=_blank rel=noopener>SubRip</a>とほぼ一緒)、翻訳は字幕が表示される時間の次の行の文字列と、その行のインデックスとともに取ればなんとか入れ替えができそうな気がしました。実際のファイルは以下のようなフォーマットで作成されています。</p><pre tabindex=0><code class=language-vtt data-lang=vtt>WEBVTT

00:01.000 --&gt; 00:04.000
液体窒素を絶対に飲まないでください。

00:05.000 --&gt; 00:09.000
- それはあなたの胃に穴をあけます。
- あなたは死ぬ可能性があります。
</code></pre><h3 id=言語翻訳api>言語翻訳API</h3><p>翻訳についてはGoogle翻訳もありますが、友人の要請によって<a class=link href=https://papago.naver.com/ target=_blank rel=noopener>Papago</a>を使うことにしました。幸いAPIを無料で利用できて、PythonのサンプルコードやAPIの詳細も提供されていたのであまり利用は難しくはい感じでした。事前にPostmanでAPIを実行してみてからこちらを採用することにしました。</p><h3 id=技術>技術</h3><p>まずPythonで作ることにしました。この規模の小さいアプリは、Kotlinがメインの私でもPythonで書きたいと思っています。JVMだと起動が遅くなるのもあり、テキストを扱うだけでCPUの処理がクリティカルな作業でもないためパフォーマンスを考慮する必要もあまりありません。そして既にPythonでファイルを読み込んだり、ファイルを編集するなど色々とCLI用のツールを作っていたので「ファイルを読み込んで、編集して、保存する」という最重要の機能がすぐに実装できそうと思いました。</p><p>ただ、自分が使うものならCLI上でも十分使えますが、友人が使うものなのGUIを実装することにしました。Pythonは<code>.py</code>ファイルで渡すと、Pythonとスクリプトのdependencyのインストールが必要となるなどエンジニアではない人が触るには不便なところがあるので、成果物は<a class=link href=https://pyinstaller.org/en/stable/ target=_blank rel=noopener>PyInstaler</a>などで実行できるバイナリにします。</p><p>GUIに関しては<a class=link href=https://pysimplegui.readthedocs.io/en/latest/ target=_blank rel=noopener>PySimpleGUI</a>を使ったことがありますが、今回は違うフレームワークを使ってみたいと思いました。PythonのGUIフレームワークといえば<a class=link href=https://docs.python.org/ja/3/library/tkinter.html target=_blank rel=noopener>tkinter</a>や<a class=link href=https://kivy.org target=_blank rel=noopener>Kivy</a>、<a class=link href=https://www.wxpython.org/ target=_blank rel=noopener>wxPython</a>、<a class=link href=https://www.libavg.de/site/ target=_blank rel=noopener>Libavg</a>など様々なものがあるのですが、中でも<a class=link href=https://www.qt.io/ target=_blank rel=noopener>Qt</a>がPythonだけでなく色々と使われているので、PythonのコードだけでなくC++のコードでも参考できる例が多いのではないかと思い<a class=link href=https://wiki.python.org/moin/PyQt target=_blank rel=noopener>PyQt</a>の方を選びました。</p><p>プロダクションレベルのものを作るならまた色々と基準を持って検討してみたかもしれませんが、このような趣味レベルのコードを書く場合はなるべく手軽に書ける、サンプルの多いものを選ぶのがちょうど良いかもですね。効率というのも大事なので。</p><h2 id=コード>コード</h2><h3 id=ファイル読み込み>ファイル読み込み</h3><p>まずはファイルを読み込むところから始めます。<code>.vtt</code>ファイルはヘッダーに字幕の情報（言語コードなど）が書かれていて、その次からは字幕が表示される時間と字幕の文字列が繰り返されます。</p><p>素直に全行を読み込んでも良いかもですが、翻訳のAPIを呼び出すときに一日で利用できる文字数の制限というのがあったので、極力リクエストにのせるデータは減らしたかったです。なので、後で入れ替えするためのもとのファイルのデータと、翻訳のためAPIのリクエストパラメータにのせる二つのデータにわけで読み込むようにしました。いかがそのコードです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># get original contents from vtt file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_content</span>(self, file_path: str):
</span></span><span style=display:flex><span>    exported_contents: dict[int, str] <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> source
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(file_path, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        original_contents: list[str] <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> index, line <span style=color:#f92672>in</span> enumerate(original_contents):
</span></span><span style=display:flex><span>            content <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> source <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#f92672>and</span> <span style=color:#e6db74>&#39;Language:&#39;</span> <span style=color:#f92672>in</span> content:
</span></span><span style=display:flex><span>                source <span style=color:#f92672>=</span> content<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;:&#39;</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;--&gt;&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> content <span style=color:#f92672>and</span> content <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>:
</span></span><span style=display:flex><span>                exported_contents[index] <span style=color:#f92672>=</span> content
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> original_contents, exported_contents
</span></span></code></pre></div><p>APIのパラメータには元の言語(source)と、翻訳したい言語(target)が必要となるので、Global変数として字幕のヘッダにある言語情報を<code>source</code>に格納、翻訳したい行はインデックスと文字列をdictionaryとして格納します。そして最終的に元のデータと、翻訳対象のデータを返します。</p><h3 id=翻訳apiの呼び出し>翻訳APIの呼び出し</h3><p>抽出したデータのうち、翻訳対象のデータを渡してAPIを呼び出す部分です。APIには「1秒当たり10件のリクエストを許容」するという制約があり、翻訳した文字列を一行づつ送って翻訳してもらいながら、リクエストごとに120msを待つようにしました。基本的には<a class=link href=https://docs.python-requests.org/en/latest/ target=_blank rel=noopener>Requests</a>を使ってPOSTしているだけですが、もしエラーが返ってきたときはalertを表示してアプリを即終了するようにしています。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># send translate request to papago and get translated message</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_request</span>(self, contents: dict[int, str]):
</span></span><span style=display:flex><span>    translated_contents: dict[int, str] <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    headers <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;X-Naver-Client-Id&#39;</span>: client_id,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;X-Naver-Client-Secret&#39;</span>: client_secret,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;Content-Type&#39;</span>: <span style=color:#e6db74>&#39;application/x-www-form-urlencoded; charset=UTF-8&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, content <span style=color:#f92672>in</span> contents<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;text&#39;</span>: content,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;source&#39;</span>: source,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;target&#39;</span>: target
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(api_url, headers<span style=color:#f92672>=</span>headers, data<span style=color:#f92672>=</span>payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span>:
</span></span><span style=display:flex><span>            body <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>            translated_text: str <span style=color:#f92672>=</span> body[<span style=color:#e6db74>&#39;message&#39;</span>][<span style=color:#e6db74>&#39;result&#39;</span>][<span style=color:#e6db74>&#39;translatedText&#39;</span>]
</span></span><span style=display:flex><span>            translated_contents[index] <span style=color:#f92672>=</span> translated_text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># wait for API&#39;s limitation(only 10 request per second allowed)</span>
</span></span><span style=display:flex><span>            sleep(<span style=color:#ae81ff>0.12</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            msgBox <span style=color:#f92672>=</span> QMessageBox()<span style=color:#f92672>.</span>critical(
</span></span><span style=display:flex><span>                self,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;Error&#39;</span>,
</span></span><span style=display:flex><span>                response<span style=color:#f92672>.</span>json()[<span style=color:#e6db74>&#39;errorMessage&#39;</span>],
</span></span><span style=display:flex><span>                buttons<span style=color:#f92672>=</span>QMessageBox<span style=color:#f92672>.</span>StandardButton<span style=color:#f92672>.</span>Abort
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> msgBox <span style=color:#f92672>==</span> QMessageBox<span style=color:#f92672>.</span>StandardButton<span style=color:#f92672>.</span>Abort:
</span></span><span style=display:flex><span>                sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>255</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> translated_contents
</span></span></code></pre></div><h3 id=ファイルの保存>ファイルの保存</h3><p>ロジックとしてはここが最後です。元のファイルのある場所に翻訳された字幕ファイルを保存するために、元のファイルのパス、翻訳したものに入れ替えるための元のデータ、そしてAPIで翻訳した結果のデータを渡します。</p><p>基本的に翻訳したデータにはインデックスがkeyとして入っているので、そのキーを持って元のデータを入れ替えていきます。ここでヘッダには元の言語のコードが入っているので、翻訳した言語のコードに入れ替えます。そしてファイル名にも同じく言語のコードが入っているので、これもまた変えておきます。</p><p>全てのデータが入れ替えられ、ファイル名を決めたら保存して終了です。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># write translated contents to file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>write_result</span>(self, file_path: str, original_contents: list[str], translated_contents: dict[int, str]):
</span></span><span style=display:flex><span>    contents <span style=color:#f92672>=</span> original_contents<span style=color:#f92672>.</span>copy()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, content <span style=color:#f92672>in</span> translated_contents<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;Language:&#39;</span> <span style=color:#f92672>in</span> content:
</span></span><span style=display:flex><span>            contents[index] <span style=color:#f92672>=</span> content<span style=color:#f92672>.</span>replace(source, target) <span style=color:#f92672>+</span> line_separator
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            contents[index] <span style=color:#f92672>=</span> content <span style=color:#f92672>+</span> line_separator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    root <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(file_path)
</span></span><span style=display:flex><span>    file_name <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(file_path)<span style=color:#f92672>.</span>replace(source, target)
</span></span><span style=display:flex><span>    target_file_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(root, file_name)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(target_file_path, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>writelines(contents)
</span></span></code></pre></div><h3 id=ファイルドロップダウン>ファイルドロップダウン</h3><p>せっかくGUIを使っているので、<a class=link href=https://doc.qt.io/qtforpython-5/PySide2/QtWidgets/QListWidget.html target=_blank rel=noopener>QListWidget</a>にファイルをDrag & Dropすると勝手にファイル名が画面に表示され、翻訳対象にもなるようにしたかったです。ここはあまり自分がQtに詳しくないので、ネットで検索したものを流用しました。</p><p>基本的にはファイルをDrag & Dropすると、拡張子が<code>.vtt</code>の場合にリストに追加されます。ここでファイルのフルパスを得ることができるのですが、画面上はファイル名だけを見えるようにして、フルパスは別のグローバル変数に格納するようにしています。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># drop down file list</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileListView</span>(QListWidget):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, parent<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        super(FileListView, self)<span style=color:#f92672>.</span>__init__(parent)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>setAcceptDrops(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dragEnterEvent</span>(self, event):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> event<span style=color:#f92672>.</span>mimeData()<span style=color:#f92672>.</span>hasUrls:
</span></span><span style=display:flex><span>            event<span style=color:#f92672>.</span>accept()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            event<span style=color:#f92672>.</span>ignore()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dragMoveEvent</span>(self, event):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> event<span style=color:#f92672>.</span>mimeData()<span style=color:#f92672>.</span>hasUrls:
</span></span><span style=display:flex><span>            event<span style=color:#f92672>.</span>accept()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            event<span style=color:#f92672>.</span>ignore()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dropEvent</span>(self, event):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> event<span style=color:#f92672>.</span>mimeData()<span style=color:#f92672>.</span>hasUrls:
</span></span><span style=display:flex><span>            event<span style=color:#f92672>.</span>accept()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> url <span style=color:#f92672>in</span> event<span style=color:#f92672>.</span>mimeData()<span style=color:#f92672>.</span>urls():
</span></span><span style=display:flex><span>                file_path <span style=color:#f92672>=</span> url<span style=color:#f92672>.</span>toLocalFile()
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> file_path<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;.vtt&#39;</span>) <span style=color:#f92672>and</span> str(file_path) <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> original_files:
</span></span><span style=display:flex><span>                    <span style=color:#75715e># add file path to list</span>
</span></span><span style=display:flex><span>                    original_files<span style=color:#f92672>.</span>append(str(file_path))
</span></span><span style=display:flex><span>                    <span style=color:#75715e># add file name to file list view</span>
</span></span><span style=display:flex><span>                    self<span style=color:#f92672>.</span>addItem(file_path<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            event<span style=color:#f92672>.</span>ignore()
</span></span></code></pre></div><h3 id=ファイル削除>ファイル削除</h3><p>リストにファイルを追加したら削除したい場合もあるかと思ったので、リストからファイルを選択してボタンを押すとリストから消えるようにしたかったです。これは以下のようなコードで実現しています。ボタンをクリックすると、リストで選択したものが消え、翻訳対象（フルパス）からも消えるようにしています。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># create remove button</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_remove_button</span>(self):
</span></span><span style=display:flex><span>    button <span style=color:#f92672>=</span> QPushButton()
</span></span><span style=display:flex><span>    button<span style=color:#f92672>.</span>setText(<span style=color:#e6db74>&#39;Remove file&#39;</span>)
</span></span><span style=display:flex><span>    button<span style=color:#f92672>.</span>clicked<span style=color:#f92672>.</span>connect(self<span style=color:#f92672>.</span>remove_file)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> button
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># remove file from file list</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>remove_file</span>(self):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> original_files
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> selected_item <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>list_view<span style=color:#f92672>.</span>selectedIndexes():
</span></span><span style=display:flex><span>        index <span style=color:#f92672>=</span> selected_item<span style=color:#f92672>.</span>row()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>list_view<span style=color:#f92672>.</span>takeItem(index)
</span></span><span style=display:flex><span>        original_files<span style=color:#f92672>.</span>pop(index)
</span></span></code></pre></div><h3 id=言語選択>言語選択</h3><p>元の字幕ファイルの言語はヘッダから抽出できるのですが、どの言語に翻訳したいかは自分で選べるようにしました。ここは翻訳APIの使用を参考にして、翻訳可能な言語のコードをdictionaryとしています。あえてdictionaryとしている理由は、<a class=link href=https://doc.qt.io/qtforpython-5/PySide2/QtWidgets/QComboBox.html target=_blank rel=noopener>QComboBox</a>のアイテムは画面に見えるものなので実際の言語名にしたかったからです。アイテムがdictionaryのキーとなっているので、選択したアイテムに対応するvalueが翻訳したい言語となるようにしています。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># languages</span>
</span></span><span style=display:flex><span>supported_language_code: dict[str, str] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Korean&#39;</span>: <span style=color:#e6db74>&#39;ko&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;English&#39;</span>: <span style=color:#e6db74>&#39;en&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Japanese&#39;</span>: <span style=color:#e6db74>&#39;ja&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Chinese(China)&#39;</span>: <span style=color:#e6db74>&#39;zh-CN&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Chinese(Taiwan)&#39;</span>: <span style=color:#e6db74>&#39;zh-TW&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Vietnamese&#39;</span>: <span style=color:#e6db74>&#39;vi&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Indonesian&#39;</span>: <span style=color:#e6db74>&#39;id&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Thailand&#39;</span>: <span style=color:#e6db74>&#39;th&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;German&#39;</span>: <span style=color:#e6db74>&#39;de&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Russian&#39;</span>: <span style=color:#e6db74>&#39;ru&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Spanish&#39;</span>: <span style=color:#e6db74>&#39;es&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;French&#39;</span>: <span style=color:#e6db74>&#39;fr&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># create drop down menu</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_target_language_selector</span>(self):
</span></span><span style=display:flex><span>    label <span style=color:#f92672>=</span> QLabel()
</span></span><span style=display:flex><span>    label<span style=color:#f92672>.</span>setText(<span style=color:#e6db74>&#39;Select target language&#39;</span>)
</span></span><span style=display:flex><span>    selector <span style=color:#f92672>=</span> QComboBox()
</span></span><span style=display:flex><span>    selector<span style=color:#f92672>.</span>addItems(supported_language_code<span style=color:#f92672>.</span>keys())
</span></span><span style=display:flex><span>    selector<span style=color:#f92672>.</span>textActivated<span style=color:#f92672>.</span>connect(self<span style=color:#f92672>.</span>set_target_language)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> label, selector
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># set translate target language when dropdown menu selected</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>set_target_language</span>(self, selectd: str):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> supported_language_code
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> target
</span></span><span style=display:flex><span>    target <span style=color:#f92672>=</span> supported_language_code[selectd]
</span></span></code></pre></div><h3 id=翻訳ボタン>翻訳ボタン</h3><p>最後に翻訳ボタンを追加して、実際の翻訳はボタンを押下した時に行われるようにしました。ボタンを押すと、翻訳対象のファイルのパスをループしながらデータの読み込み、元の言語と翻訳したい言語が違うと翻訳APIの呼び出し、結果の保存という作業を行うようになっています。念の為処理が行われる間はこのボタンを非活性化するという処理も追加しています。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># create translate button</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_translate_button</span>(self):
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>translate_button <span style=color:#f92672>=</span> QPushButton()
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>translate_button<span style=color:#f92672>.</span>setText(<span style=color:#e6db74>&#39;Translate&#39;</span>)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>translate_button<span style=color:#f92672>.</span>clicked<span style=color:#f92672>.</span>connect(self<span style=color:#f92672>.</span>translate_files)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>translate_button<span style=color:#f92672>.</span>setDisabled(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># read vtt file and do translate</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>translate_files</span>(self):
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>translate_button<span style=color:#f92672>.</span>setDisabled(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> file_path <span style=color:#f92672>in</span> original_files:
</span></span><span style=display:flex><span>        original_contents, exported_contents <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>get_content(file_path)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> source <span style=color:#f92672>==</span> target:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>        translated_contents <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>send_request(exported_contents)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>write_result(file_path, original_contents, translated_contents)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>translate_button<span style=color:#f92672>.</span>setDisabled(<span style=color:#66d9ef>False</span>)
</span></span></code></pre></div><p>実際作ったツールで重要な部分は以上で、全体のソースコードは<a class=link href=https://github.com/retheviper/PythonTools/blob/master/PapagoVtt/papago_vtt.py target=_blank rel=noopener>こちらから</a>確認できます。</p><h2 id=改善したい>改善したい</h2><p>こうやってとりわけ欲しい機能は実現できたのですが、まだ自分がPyQtに慣れてないのもあり、ロジック上でも少し改善したいところは残っていますので、いくつかを挙げてみました。</p><h3 id=テキストをまとめて翻訳する>テキストをまとめて翻訳する</h3><p>翻訳APIの仕様上、リクエストは1秒で10回となっているため、<code>sleep</code>を入れて一つのリクエスト毎に120msを待つようになっています。I/Oが発生することを考慮するともっと間隔を短くしてよかったかもしれませんが、そもそもの問題は、読み込んだファイルのデータから一行づつ翻訳のリクエストを送っているところです。短い動画でも字幕は数百行となるケースがあるので、こうなった場合は全体の翻訳が終わるまで処理にかなり時間がかかってしまいますね。</p><p>なので、最初はリクエストパラメータに翻訳したいデータを全て送る（dictionaryのvalueを一つのstrにjoinして）方法も考えてみましたが、APIの仕様として明示されてないだけで、リクエストパラメータのサイズには制限があるようでした。だとすると、翻訳したいデータをいくつかのchunkに分けて送るという方法があると思いますが、こうなった場合は最後にファイルを保存するときに入れ替えるデータの行をどうやって判断するか、それをうまく処理するための方法が悩ましくなります。</p><p>この処理のためファイルを翻訳するまでの時間がかなり長くなるので、いつかは解消したいものですが、翻訳した結果をうまくまとめて保存できる方法が思いつくまでは少し時間がかかりそうです。</p><h3 id=プログレスバーを追加する>プログレスバーを追加する</h3><p>今の作りだと、シングルスレッドであるため、一つのファイルに対して処理が行われている間は画面が固まってしまうという問題があります。そもそも処理が遅いので、かなり長い時間を固まっていますが、これはUXの観点ではあまり良くないですね。また、処理がどこまで終わっているかもわからないので、プログレスバーを追加して、一つのファイルおよび全体のリストでどれぐらいの処理が行われているかを視覚化したいと思っています。</p><p>ただ、プログレスバーを追加する場合、スレッドをわけ、さらに何を基準にプログレスバーを動いていくかというロジックを考えなければならないので、そこもまた時間がかかりそうですね。</p><h3 id=ボタンの非活性化>ボタンの非活性化</h3><p>翻訳対象のファイルが追加される前と処理の途中ではボタンを非活性化したいのですが、これもまだうまく実装されていません。処理中に画面が固まってしまうからか、処理の前後でボタンを非活性化するという処理も思い通りにならなかったのでこちらも直したいと思っています。</p><h2 id=最後に>最後に</h2><p>今回はGUIを中心に色々と新しいチャレンジができたので、かなり面白い作業となっています。そしてやはり元がサーバサイドだからか、UI/UXの観点では考慮しきれなかった問題が出てきたり、画面を実装するためにも色々と試行錯誤があったのでこれは良い勉強になっています。PythonとPyQtが優秀だったのでできたものなのですが、これをまたJetpack Composeなどで書き換えてみるとどうなるかなという好奇心もありますね。やはり、普段やってみてないことに挑戦してみるのは自分がエンジニアとして成長するための良い糧となるような気がします。</p><p>では、また！</p></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>python</a>
<a href=/tags/qt/>qt</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/python-blob-to-binary/><div class=article-image><img src=/../../images/python.jpg loading=lazy data-key data-hash=/../../images/python.jpg></div><div class=article-details><h2 class=article-title>PythonでDBの処理がしたい</h2></div></a></article><article class=has-image><a href=/posts/python-xml-modifier-2/><div class=article-image><img src=/../../images/python.jpg loading=lazy data-key data-hash=/../../images/python.jpg></div><div class=article-details><h2 class=article-title>Pythonでxmlファイルを操作する(2)</h2></div></a></article><article class=has-image><a href=/posts/python-logger/><div class=article-image><img src=/../../images/python.jpg loading=lazy data-key data-hash=/../../images/python.jpg></div><div class=article-details><h2 class=article-title>Pythonでログを出したい</h2></div></a></article><article class=has-image><a href=/posts/python-xml-modifier-1/><div class=article-image><img src=/../../images/python.jpg loading=lazy data-key data-hash=/../../images/python.jpg></div><div class=article-details><h2 class=article-title>Pythonでxmlファイルを操作する(1)</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2019 -
2024 Korean-man in Tokyo</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.20.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>